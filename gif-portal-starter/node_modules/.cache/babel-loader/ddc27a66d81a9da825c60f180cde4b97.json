{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.u64 = exports.COptionLayout = exports.coption = exports.publicKey = exports.bool = exports.uint64 = void 0;\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\nconst BufferLayout = __importStar(require(\"buffer-layout\"));\nconst buffer_layout_1 = require(\"buffer-layout\");\nconst web3_js_1 = require(\"@solana/web3.js\");\nfunction uint64(property) {\n  return new WrappedLayout(BufferLayout.blob(8), b => u64.fromBuffer(b), n => n.toBuffer(), property);\n}\nexports.uint64 = uint64;\nfunction bool(property) {\n  return new WrappedLayout(BufferLayout.u8(), decodeBool, encodeBool, property);\n}\nexports.bool = bool;\nfunction publicKey(property) {\n  return new WrappedLayout(BufferLayout.blob(32), b => new web3_js_1.PublicKey(b), key => key.toBuffer(), property);\n}\nexports.publicKey = publicKey;\nfunction coption(layout, property) {\n  return new COptionLayout(layout, property);\n}\nexports.coption = coption;\nclass WrappedLayout extends buffer_layout_1.Layout {\n  constructor(layout, decoder, encoder, property) {\n    super(layout.span, property);\n    this.layout = layout;\n    this.decoder = decoder;\n    this.encoder = encoder;\n  }\n  decode(b, offset) {\n    return this.decoder(this.layout.decode(b, offset));\n  }\n  encode(src, b, offset) {\n    return this.layout.encode(this.encoder(src), b, offset);\n  }\n  getSpan(b, offset) {\n    return this.layout.getSpan(b, offset);\n  }\n}\nclass COptionLayout extends buffer_layout_1.Layout {\n  constructor(layout, property) {\n    super(-1, property);\n    this.layout = layout;\n    this.discriminator = BufferLayout.u32();\n  }\n  encode(src, b) {\n    let offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    if (src === null || src === undefined) {\n      return this.layout.span + this.discriminator.encode(0, b, offset);\n    }\n    this.discriminator.encode(1, b, offset);\n    return this.layout.encode(src, b, offset + 4) + 4;\n  }\n  decode(b) {\n    let offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    const discriminator = this.discriminator.decode(b, offset);\n    if (discriminator === 0) {\n      return null;\n    } else if (discriminator === 1) {\n      return this.layout.decode(b, offset + 4);\n    }\n    throw new Error(\"Invalid coption \" + this.layout.property);\n  }\n  getSpan(b) {\n    let offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return this.layout.getSpan(b, offset + 4) + 4;\n  }\n}\nexports.COptionLayout = COptionLayout;\nfunction decodeBool(value) {\n  if (value === 0) {\n    return false;\n  } else if (value === 1) {\n    return true;\n  }\n  throw new Error(\"Invalid bool: \" + value);\n}\nfunction encodeBool(value) {\n  return value ? 1 : 0;\n}\nclass u64 extends bn_js_1.default {\n  /**\n   * Convert to Buffer representation\n   */\n  toBuffer() {\n    const a = super.toArray().reverse();\n    const b = Buffer.from(a);\n    if (b.length === 8) {\n      return b;\n    }\n    if (b.length >= 8) {\n      throw new Error(\"u64 too large\");\n    }\n    const zeroPad = Buffer.alloc(8);\n    b.copy(zeroPad);\n    return zeroPad;\n  }\n  /**\n   * Construct a u64 from Buffer representation\n   */\n  static fromBuffer(buffer) {\n    if (buffer.length !== 8) {\n      throw new Error(`Invalid buffer length: ${buffer.length}`);\n    }\n    return new u64([...buffer].reverse().map(i => `00${i.toString(16)}`.slice(-2)).join(\"\"), 16);\n  }\n}\nexports.u64 = u64;","map":{"version":3,"mappings":"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","names":["uint64","property","WrappedLayout","BufferLayout","blob","b","u64","fromBuffer","n","toBuffer","exports","bool","u8","decodeBool","encodeBool","publicKey","web3_js_1","key","coption","layout","COptionLayout","buffer_layout_1","constructor","decoder","encoder","span","decode","offset","encode","src","getSpan","discriminator","u32","undefined","Error","value","bn_js_1","a","toArray","reverse","Buffer","from","length","zeroPad","alloc","copy","buffer","map","i","toString","slice","join"],"sourceRoot":"","sources":["../../../../src/coder/spl-token/buffer-layout.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}